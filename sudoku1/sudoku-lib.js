!function(){var r={DIGITS:"123456789"},n="ABCDEFGHI",a=r.DIGITS,e=null,i=null,t=null,f=null,o={debug:71,easy:62,medium:53,hard:44,"very hard":35,insane:26,daily:30,inhuman:17};r.BLANK_CHAR=".",r.BLANK_BOARD=".................................................................................",r.generate=function(n,a){"string"!=typeof n&&void 0!==n||(n=o[n]||o.easy),n=r._force_range(n,82,10),a=a||!0;for(var i="",t=0;t<81;++t)i+=".";var f=r._get_candidates_map(i),u=r._shuffle(e);for(var _ in u){var v=u[_],s=r._rand_range(f[v].length),l=f[v][s];if(!r._assign(f,v,l))break;var h=[];for(var _ in e){1==f[v=e[_]].length&&h.push(f[v])}if(h.length>=n&&r._strip_dups(h).length>=8){var g="",d=[];for(var t in e){1==f[v=e[t]].length?(g+=f[v],d.push(t)):g+=r.BLANK_CHAR}var c=d.length;if(c>n){d=r._shuffle(d);for(t=0;t<c-n;++t){var p=parseInt(d[t]);g=g.substr(0,p)+r.BLANK_CHAR+g.substr(p+1)}}if(r.solve(g))return g}}return r.generate(n)},r.solve=function(n,a){var e=r.validate_board(n);if(!0!==e)throw e;var i=0;for(var t in n)n[t]!==r.BLANK_CHAR&&r._in(n[t],r.DIGITS)&&++i;if(i<10)throw"Too few givens. Minimum givens is 10";a=a||!1;var f=r._get_candidates_map(n),o=r._search(f,a);if(o){var u="";for(var _ in o)u+=o[_];return u}return!1},r.get_candidates=function(n){var a=r.validate_board(n);if(!0!==a)throw a;var e=r._get_candidates_map(n);if(!e)return!1;var i=[],t=[],f=0;for(var o in e){var u=e[o];t.push(u),f%9==8&&(i.push(t),t=[]),++f}return i},r._get_candidates_map=function(n){var a=r.validate_board(n);if(!0!==a)throw a;var i={},t=r._get_square_vals_map(n);for(var f in e)i[e[f]]=r.DIGITS;for(var o in t){var u=t[o];if(r._in(u,r.DIGITS))if(!r._assign(i,o,u))return!1}return i},r._search=function(n,a){if(!n)return!1;a=a||!1;var i=0;for(var t in e){(_=n[u=e[t]].length)>i&&(i=_,u)}if(1===i)return n;var f=10,o=null;for(t in e){var u,_;(_=n[u=e[t]].length)<f&&_>1&&(f=_,o=u)}var v=n[o];if(a)for(s=v.length-1;s>=0;--s){h=v[s],g=JSON.parse(JSON.stringify(n));if(l=r._search(r._assign(g,o,h),a))return l}else for(var s in v){var l,h=v[s],g=JSON.parse(JSON.stringify(n));if(l=r._search(r._assign(g,o,h)))return l}return!1},r._assign=function(n,a,e){var i=n[a].replace(e,"");for(var t in i){var f=i[t];if(!r._eliminate(n,a,f))return!1}return n},r._eliminate=function(n,a,e){if(!r._in(e,n[a]))return n;n[a]=n[a].replace(e,"");var i=n[a].length;if(1===i){var o=n[a];for(var u in f[a]){var _=f[a][u];if(!r._eliminate(n,_,o))return!1}}if(0===i)return!1;for(var v in t[a]){var s=t[a][v],l=[];for(var h in s){var g=s[h];r._in(e,n[g])&&l.push(g)}if(0===l.length)return!1;if(1===l.length&&!r._assign(n,l[0],e))return!1}return n},r._get_square_vals_map=function(r){var n={};if(r.length!=e.length)throw"Board/squares length mismatch.";for(var a in e)n[e[a]]=r[a];return n},r._get_square_units_map=function(r,n){var a={};for(var e in r){var i=r[e],t=[];for(var f in n){var o=n[f];-1!==o.indexOf(i)&&t.push(o)}a[i]=t}return a},r._get_square_peers_map=function(r,n){var a={};for(var e in r){var i=r[e],t=n[i],f=[];for(var o in t){var u=t[o];for(var _ in u){var v=u[_];-1===f.indexOf(v)&&v!==i&&f.push(v)}}a[i]=f}return a},r._get_all_units=function(n,a){var e=[];for(var i in n)e.push(r._cross(n[i],a));for(var t in a)e.push(r._cross(n,a[t]));var f=["ABC","DEF","GHI"],o=["123","456","789"];for(var u in f)for(var _ in o)e.push(r._cross(f[u],o[_]));return e},r.board_string_to_grid=function(r){var n=[],a=[];for(var e in r)a.push(r[e]),e%9==8&&(n.push(a),a=[]);return n},r.board_grid_to_string=function(r){for(var n="",a=0;a<9;++a)for(var e=0;e<9;++e)n+=r[a][e];return n},r.print_board=function(n){var a=r.validate_board(n);if(!0!==a)throw a;var e="";for(var i in n){e+=n[i]+" ",i%3==2&&(e+="  "),i%9==8&&(e+="\n"),i%27==26&&(e+="\n")}console.log(e)},r.validate_board=function(n){if(!n)return"Empty board";if(81!==n.length)return"Invalid board size. Board must be exactly 81 squares.";for(var a in n)if(!r._in(n[a],r.DIGITS)&&n[a]!==r.BLANK_CHAR)return"Invalid board character encountered at index "+a+": "+n[a];return!0},r._cross=function(r,n){var a=[];for(var e in r)for(var i in n)a.push(r[e]+n[i]);return a},r._in=function(r,n){return-1!==n.indexOf(r)},r._first_true=function(r){for(var n in r)if(r[n])return r[n];return!1},r._shuffle=function(n){for(var a=[],e=0;e<n.length;++e)a.push(!1);for(var e in n){for(var i=r._rand_range(n.length);a[i];)i=i+1>n.length-1?0:i+1;a[i]=n[e]}return a},r._rand_range=function(r,n){if(n=n||0,r)return Math.floor(Math.random()*(r-n))+n;throw"Range undefined"},r._strip_dups=function(r){var n=[],a={};for(var e in r){var i=r[e];a[i]||(n.push(i),a[i]=!0)}return n},r._force_range=function(r,n,a){return(r=r||0)<(a=a||0)?a:r>n?n:r},e=r._cross(n,a),i=r._get_all_units(n,a),t=r._get_square_units_map(e,i),f=r._get_square_peers_map(e,t),void 0===window.playtouchGame&&(window.playtouchGame={}),window.playtouchGame.main=r}();