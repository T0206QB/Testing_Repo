(function(){function t(t,i,s){return Math.min(s,Math.max(i,t))}function i(t,i){return Math.round(t/i)*i}var s={objListMoved:"objListMoved",objListRemoved:"objListRemoved"},o={VERTICAL:"vertical",HORIZONTAL:"horizontal"},e=function(){};e.prototype.C2_RUNTIME=cr_getC2Runtime(),e.prototype.waitList={},e.prototype.isInit=!1,e.prototype.init=function(t){if(!this.isInit)return this.isInit=!0,this.waitList={},this},e.prototype.createList=function(t,i,s,e,n){if(!this.waitList[t]){t=t,s=void 0!==s?s:0,e=void 0!==e?e:0,i=void 0===i||i!==o.HORIZONTAL&&i!==o.VERTICAL?o.VERTICAL:i,n=void 0!==n?n:0;this.waitList[t]=(new h).create(this,t,i,s,e,n),this.checkListCount(!0)}},e.prototype.removeList=function(t){this.waitList[t]&&(delete this.waitList[t],this.checkListCount(!1))},e.prototype.checkListCount=function(t){var i=0;for(var s in this.waitList)i++;0===i&&this.C2_RUNTIME.untick2Me(this),1===i&&t&&this.C2_RUNTIME.tick2Me(this)},e.prototype.tick2=function(){for(var t in this.waitList)this.waitList[t].update(this.C2_RUNTIME.getDt())},e.prototype.setActivated=function(t,i){this.waitList[t]&&this.waitList[t].setActivated(!!i)},e.prototype.setStartPos=function(t,i){this.waitList[t]&&this.waitList[t].setStartPos(void 0!==i?i:0)},e.prototype.setOrientation=function(t,i){this.waitList[t]&&this.waitList[t].setOrientation(void 0===i||i!==o.HORIZONTAL&&i!==o.VERTICAL?o.VERTICAL:i)},e.prototype.setOffset=function(t,i){this.waitList[t]&&this.waitList[t].setOffset(void 0!==i?i:0)},e.prototype.setHeight=function(t,i){this.waitList[t]&&this.waitList[t].setHeight(void 0!==i?i:0)},e.prototype.setOffsetStart=function(t,i){this.waitList[t]&&this.waitList[t].setOffsetStart(void 0!==i?i:0)},e.prototype.setRoundScroll=function(t,i){this.waitList[t]&&this.waitList[t].setRoundScroll(!(void 0===i||!i))},e.prototype.setClampObject=function(t,i,s,o){this.waitList[t]&&this.waitList[t].setClampObject(void 0!==i?i:null,void 0!==s?s:null,void 0!==o?o:0)},e.prototype.setCanMoveByUid=function(t,i,s){this.waitList[t]&&this.waitList[t].setCanMoveByUid(i,!!s)},e.prototype.setVisibleObject=function(t,i,s){this.waitList[t]&&this.waitList[t].setVisibleObject(i,!!s)},e.prototype.setTemporaryPosDrop=function(t,i){this.waitList[t]&&this.waitList[t].setTemporaryPosDrop(i)},e.prototype.getPercentObjectOnList=function(t,i){if(this.waitList[t])return this.waitList[t].getPercentObjectOnList(i)},e.prototype.getVisibleObjectCount=function(t){if(this.waitList[t])return this.waitList[t].getVisibleObject()},e.prototype.getObjectCount=function(t){if(this.waitList[t])return this.waitList[t].getObjectCount()},e.prototype.getPosObjectByUid=function(t,i){return this.waitList[t]?this.waitList[t].getPosObjectByUid(i):-1},e.prototype.uidIsOnList=function(t,i){return!!this.waitList[t]&&this.waitList[t].uidIsOnList(i)},e.prototype.endMove=function(t){this.waitList[t]&&this.waitList[t].endMove()},e.prototype.move=function(t,i){this.waitList[t]&&this.waitList[t].addScroll(i)},e.prototype.moveTo=function(t,i){this.waitList[t]&&this.waitList[t].setScroll(i)},e.prototype.movePercent=function(t,i){this.waitList[t]&&this.waitList[t].setScrollPercent(i)},e.prototype.moveToPercent=function(t,i){this.waitList[t]&&this.waitList[t].addScrollPercent(i)},e.prototype.addImpulsion=function(t,i){this.waitList[t]&&this.waitList[t].addImpulsion(i)},e.prototype.stopImpulsion=function(t){this.waitList[t]&&this.waitList[t].stopImpulsion()},e.prototype.addToList=function(t,i,s){if(this.waitList[t]){var o=this.C2_RUNTIME.getObjectByUID(i);this.waitList[t].addToList(i,o,s)}},e.prototype.removeToList=function(t,i){this.waitList[t]&&this.waitList[t].removeToList(i)},e.prototype.removeAllToList=function(t){this.waitList[t]&&this.waitList[t].removeAll()};var h=function(){};h.prototype.create=function(t,i,s,o,e,h){return this.activated=!0,this.waitingListManager=t,this.updateVisibility=!0,this.listName=i,this.orientation=s,this.startPos=o,this.offset=h,this.offsetScroll=this.offset/2,this.offsetStart=0,this.roundScroll=!1,this.listOfObjectVisible=0,this.temporaryPos=-1,this.INERTIA_SCROLL_FACTOR=.9,this.INERTIA_ACCELERATION=.97,this.INERTIA_THRESHOLD=20,this.inertialVelocity=0,this.clampMinPosObject=null,this.clampMaxPosObject=null,this.offsetBetweenClamp=0,this.setHeight(e),this.maxScroll=0,this.listOfObject=[],this.listOfObjectUid={},this},h.prototype.isObjectOnListExist=function(t){return void 0!==this.listOfObjectUid[t]},h.prototype.setActivated=function(t){this.activated=t},h.prototype.setStartPos=function(t){this.startPos=t},h.prototype.setOrientation=function(t){this.orientation=t},h.prototype.setOffset=function(t){this.offset=t},h.prototype.setHeight=function(t){this.baseHeight=t,this.height=this.baseHeight-this.offsetStart},h.prototype.setOffsetStart=function(t){this.offsetStart=t,this.setHeight(this.baseHeight),this.calculMaxScroll()},h.prototype.setRoundScroll=function(t){this.roundScroll=t},h.prototype.setClampObject=function(t,i,s){this.clampMinPosObject=t,this.clampMaxPosObject=i,this.offsetBetweenClamp=s},h.prototype.setCanMoveByUid=function(t,i){return!!this.isObjectOnListExist(t)&&this.listOfObjectUid[t].setCanMove(i)},h.prototype.setVisibleObject=function(t,i){if(!this.isObjectOnListExist(t))return!1;var s=this.listOfObjectUid[t].setVisible(i);s&&(this.updateVisibility=!0)},h.prototype.setTemporaryPosDrop=function(t){this.temporaryPos=t},h.prototype.getPercentObjectOnList=function(t){return!!this.isObjectOnListExist(t)&&this.listOfObjectUid[t].getPercentOnList()},h.prototype.getVisibleObject=function(){return this.listOfObjectVisible},h.prototype.getObjectCount=function(){return this.listOfObject.length},h.prototype.getPosObjectByUid=function(t){return this.isObjectOnListExist(t)?this.listOfObjectUid[t].posToShow:-1},h.prototype.uidIsOnList=function(t){return this.isObjectOnListExist(t)},h.prototype.setScroll=function(t){this.listOfObjectVisible*this.offset<=this.height||(this.offsetScroll=t,this.clampScroll())},h.prototype.addScroll=function(t){this.setScroll(t+this.offsetScroll)},h.prototype.setScrollPercent=function(t){this.setScroll(this.getScrollByPercent(t))},h.prototype.addScrollPercent=function(t){this.setScrollPercent(t+this.getScrollPercent())},h.prototype.endMove=function(){this.roundScroll&&(this.listOfObjectVisible>1&&(this.offsetScroll=this.getScrollByPercent(i(this.getScrollPercent(),100/(this.listOfObjectVisible-1)))),this.clampScroll())},h.prototype.getScrollPercent=function(){return Math.abs(100*(this.offsetScroll-this.offset/2)/(this.maxScroll-this.offset/2))},h.prototype.getScrollByPercent=function(t){return(this.maxScroll-this.offset/2)*t/100+this.offset/2},h.prototype.addImpulsion=function(t){this.inertialVelocity=t},h.prototype.stopImpulsion=function(){this.inertialVelocity=0},h.prototype.clampScroll=function(){this.offsetScroll=t(this.offsetScroll,this.maxScroll,this.offset/2)},h.prototype.calculMaxScroll=function(){this.maxScroll=this.height+this.offset/2-this.offset*this.listOfObjectVisible},h.prototype.addToList=function(i,s,o){if(this.isObjectOnListExist(i))return this.listOfObjectUid[i].update(),!1;o=void 0===o?this.listOfObject.length:t(o,0,this.listOfObject.length);for(var e=0;e<this.listOfObject.length;e++)this.listOfObject[e].pos>=o&&this.listOfObject[e].moveCaseByLogic(1);var h=(new n).create(this,s,o,!0);this.listOfObjectUid[i]=h,this.listOfObject.push(h),this.updateVisibility=!0,this.calculMaxScroll(),this.clampScroll()},h.prototype.removeToList=function(t){if(!this.isObjectOnListExist(t))return!1;for(var i,s,o=0;o<this.listOfObject.length;o++)if(this.listOfObject[o].uid===t){i=o,s=this.listOfObject[o].pos;break}if(void 0!==s){for(o=0;o<this.listOfObject.length;o++)this.listOfObject[o].pos>s&&this.listOfObject[o].moveCaseByLogic(-1);this.listOfObject[i].visible&&this.listOfObjectVisible--;var e=this.listOfObject[i];delete this.listOfObjectUid[t],this.listOfObject.splice(i,1),e.removeIt(),e=void 0,this.updateVisibility=!0,this.calculMaxScroll(),this.clampScroll()}else console.log("NEW CASE TO REMOVE FROM THE LIST IS NOT FOUND")},h.prototype.removeAll=function(){for(var t in this.listOfObjectUid)this.removeToList(parseInt(t))},h.prototype.update=function(t){if(this.activated){if(this.updateVisibility&&this.updateObjVisibility(),0!=this.inertialVelocity){this.offsetScroll+=this.inertialVelocity*this.INERTIA_SCROLL_FACTOR*t,this.inertialVelocity=this.inertialVelocity*this.INERTIA_ACCELERATION;var i=this.offsetScroll;this.clampScroll(),(Math.abs(this.inertialVelocity)<this.INERTIA_THRESHOLD||i!=this.offsetScroll)&&(this.inertialVelocity=0)}for(var s=0;s<this.listOfObject.length;s++)this.listOfObject[s].update(t)}},h.prototype.updateObjVisibility=function(){var t=0;this.listOfObject.sort(function(t,i){return t.pos-i.pos});for(var i=0;i<this.listOfObject.length;i++)this.listOfObject[i].posToShow=this.listOfObject[i].visible?t++:-1;this.listOfObjectVisible=t,this.updateVisibility=!1,this.calculMaxScroll(),this.clampScroll()};var n=function(){};n.prototype.create=function(t,i,s,o){return this.list=t,this.object=i,this.pos=void 0!==s?s:-1,this.posToShow=this.pos,this.visible=void 0===o||o,this.uid=this.object.uid,this.canMove=!0,this.update(),this},n.prototype.removeIt=function(){c2_callFunction(s.objListRemoved,[this.uid])},n.prototype.setCanMove=function(t){this.canMove=t},n.prototype.moveCaseByLogic=function(t){this.pos+=t,this.visible&&(this.posToShow+=t,this.update())},n.prototype.update=function(){if(this.list.activated&&this.canMove&&-2!=this.posToShow){this.list.waitingListManager.C2_RUNTIME.getDt(this.object);var i=this.list.orientation==o.VERTICAL?this.list.startPos:this.getPosObject(),e=this.list.orientation==o.HORIZONTAL?this.list.startPos:this.getPosObject();if(null!=this.list.clampMinPosObject&&null!=this.list.clampMaxPosObject){var h=this.list.clampMinPosObject+this.posToShow*this.list.offsetBetweenClamp,n=this.list.clampMaxPosObject-(this.list.listOfObjectVisible-1-this.posToShow)*this.list.offsetBetweenClamp;this.list.orientation==o.HORIZONTAL&&(i=t(i,h,n)),this.list.orientation==o.VERTICAL&&(e=t(e,h,n))}i==this.object.x&&e==this.object.y||(this.object.x=i,this.object.y=e,this.object.set_bbox_changed(),c2_callFunction(s.objListMoved,[this.object.uid])),-1==this.posToShow&&this.posToShow}},n.prototype.setVisible=function(t){return this.visible!=t&&(this.visible=t,!0)},n.prototype.getPosObject=function(){return this.list.offsetStart+this.list.offsetScroll+(this.posToShow+(-1!=this.list.temporaryPos&&this.posToShow>=this.list.temporaryPos?1:0))*this.list.offset},n.prototype.getPercentOnList=function(){var i=this.getPosObject()-this.list.offsetStart,s=this.list.maxScroll,e=this.list.height,h=0;if(null!=this.list.clampMinPosObject&&null!=this.list.clampMaxPosObject){h=this.list.clampMinPosObject+this.posToShow*this.list.offsetBetweenClamp-this.list.offsetStart;var n=this.list.clampMaxPosObject-(this.list.listOfObjectVisible-1-this.posToShow)*this.list.offsetBetweenClamp-this.list.offsetStart;this.list.orientation==o.HORIZONTAL&&(i=t(i,h,n)),this.list.orientation==o.VERTICAL&&(i=t(i,h,n)),s=h,e=n}return i<0||h<0?100*(i-s)/(e-s):Math.abs(100*i/(e-s))},"object"!=typeof window.playtouch&&(window.playtouch={}),playtouch.waitingListManager=(new e).init()})();